if ($request_method = 'OPTIONS') {
    add_header 'Access-Control-Allow-Origin' '{{ public_api_allow_origin }}' always;
    add_header 'Access-Control-Allow-Credentials' '{{ public_api_allow_credentials }}' always;
    add_header 'Access-Control-Allow-Methods' '{{ public_api_http_methods }}' always;
    add_header 'Access-Control-Allow-Headers' '{{ public_api_http_headers }}' always;
    add_header 'Access-Control-Expose-Headers' '{{ public_api_exposed_headers }}' always;
    add_header 'Access-Control-Max-Age' {{ public_api_control_max_age }} always;
    add_header 'Content-Type' 'text/plain charset=UTF-8' always;
    add_header 'Content-Length' 0 always;
    return 204;
}

add_header 'Access-Control-Allow-Origin' '{{ public_api_allow_origin }}' always;
add_header 'Access-Control-Allow-Credentials' '{{ public_api_allow_credentials }}' always;
add_header 'Access-Control-Allow-Methods' '{{ public_api_http_methods }}' always;
add_header 'Access-Control-Allow-Headers' '{{ public_api_http_headers }}' always;
add_header 'Access-Control-Expose-Headers' '{{ public_api_exposed_headers }}' always;
add_header 'Access-Control-Max-Age' {{ public_api_control_max_age }} always;
proxy_set_header X-Real-IP  $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto https;
proxy_set_header X-Forwarded-Port 443;
proxy_set_header Host $host;
proxy_buffering off;
proxy_connect_timeout       3600;
proxy_send_timeout          3600;
proxy_read_timeout          3600;
send_timeout                3600;
